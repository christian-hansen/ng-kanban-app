<h1>{{ error }}</h1>
<div style="display: flex; justify-content: space-between; margin-bottom: 16px; width: 100%"><h1 *ngIf="!error">Tasks</h1> <button (click)="logout()" [disabled]="isLoading">Logout</button></div>

<div style="display: flex; gap: 16px;">
    <p-panel header="To Do" pDroppable (onDrop)="drop('state1')">
        <div *ngIf="state1Tasks.length === 0">Currently no tasks in "To Do"</div>
        <p-card *ngFor="let task of state1Tasks" 
        
        pDraggable 
        pDroppable
        (onDragStart)="dragStart(task.id, 'state1')" 
        (onDragEnd)="dragEnd()"
        header="{{ task.title }}" subheader="{{ task.priority }}" [style]="{ width: '360px' }">
            <!-- <ng-template pTemplate="header">
                <img alt="Card" src="https://primefaces.org/cdn/primeng/images/card-ng.jpg" />
            </ng-template> -->
            <p>
                {{ task.id }}
            </p>
            <p>
                {{ task.description }}
            </p>
            <p>
                {{ task.state }}
            </p>
            <p>
                {{ task.created_at }}
            </p>
            <p>
                {{ task.due_date }}
            </p>
            <ng-template pTemplate="footer">
                <div>
                    <p-button label="Delete" severity="secondary" class="w-full" styleClass="w-full" [disabled]="isLoading" (click)="deleteTask(task.id)"/>
                    <p-button label="Edit" class="w-full" styleClass="w-full" [disabled]="isLoading" (click)="editTask(task.id)"/>
                    <!-- <p-button label="Sidebar" class="w-full" styleClass="w-full" [disabled]="isLoading" (click)="editTask(task.id)"/> -->
                </div>
            </ng-template>
        </p-card>
    </p-panel>

    <p-panel header="In Progress" pDroppable (onDrop)="drop('state2')">
        <p-card *ngFor="let task of state2Tasks"  
        pDraggable 
        pDroppable
        (onDragStart)="dragStart(task.id, 'state2')" 
        (onDragEnd)="dragEnd()"
        header="{{ task.title }}" subheader="{{ task.priority }}" [style]="{ width: '360px' }">
            <!-- <ng-template pTemplate="header">
                <img alt="Card" src="https://primefaces.org/cdn/primeng/images/card-ng.jpg" />
            </ng-template> -->
            <p>
                {{ task.id }}
            </p>
            <p>
                {{ task.description }}
            </p>
            <p>
                {{ task.state }}
            </p>
            <p>
                {{ task.created_at }}
            </p>
            <p>
                {{ task.due_date }}
            </p>
            <ng-template pTemplate="footer">
                <div>
                    <p-button label="Delete" severity="secondary" class="w-full" styleClass="w-full" (click)="deleteTask(task.id)"/>
                    <p-button label="Edit" class="w-full" styleClass="w-full" (click)="editTask(task.id)"/>
                </div>
            </ng-template>
        </p-card>
    </p-panel>

    <p-panel header="Awaiting Feedback" pDroppable (onDrop)="drop('state3')">
        <p-card *ngFor="let task of state3Tasks"  
        pDraggable 
        pDroppable
        (onDragStart)="dragStart(task.id, 'state3')" 
        (onDragEnd)="dragEnd()"
        header="{{ task.title }}" subheader="{{ task.priority }}" [style]="{ width: '360px' }">
            <!-- <ng-template pTemplate="header">
                <img alt="Card" src="https://primefaces.org/cdn/primeng/images/card-ng.jpg" />
            </ng-template> -->
            <p>
                {{ task.id }}
            </p>
            <p>
                {{ task.description }}
            </p>
            <p>
                {{ task.state }}
            </p>
            <p>
                {{ task.created_at }}
            </p>
            <p>
                {{ task.due_date }}
            </p>
            <ng-template pTemplate="footer">
                <div>
                    <p-button label="Delete" severity="secondary" class="w-full" styleClass="w-full" (click)="deleteTask(task.id)"/>
                    <p-button label="Edit" class="w-full" styleClass="w-full" (click)="editTask(task.id)"/>
                </div>
            </ng-template>
        </p-card>
    </p-panel>


    <p-sidebar [(visible)]="taskViewVisible" position="right" styleClass="p-sidebar-md">
        <form (ngSubmit)="saveTask()">
            <p-inplace closable="closable">
                <ng-template pTemplate="display">
                    <div>{{singleTaskData.title}}</div>
                </ng-template>
                <ng-template pTemplate="content">
                    <input type="text" value="{{singleTaskData.title}}" id="newtasktitle" name="newtasktitle" [(ngModel)]="singleTaskData.title" pInputText />
                </ng-template>
            </p-inplace>
            <div>
            <!-- <p-inplace closable="closable">
                <ng-template pTemplate="display">
                    <div>{{singleTaskData.description}}</div>
                </ng-template>
                <ng-template pTemplate="content">
                    <textarea value="{{singleTaskData.description}}" id="newtaskdescription" name="newtaskdescription" [(ngModel)]="singleTaskData.description" 
                    rows="5"
                    cols="30" 
                    pInputTextarea >
                    </textarea>
                </ng-template>
            </p-inplace> -->
            <div>
                <textarea value="{{singleTaskData.description}}" id="newtaskdescription" name="newtaskdescription" [(ngModel)]="singleTaskData.description" 
                rows="5"
                cols="30" 
                pInputTextarea >
                </textarea>
            </div>
            <div>
                <div>Due Date</div>
                <p-calendar name="dueDate" [(ngModel)]="currentDueDate" />
            </div>
            <div>
                <div>
                    <div>Priority</div>
                    <p-dropdown 
                    [options]="priorities" 
                    [(ngModel)]="singleTaskData.priority"
                    name="priority"
                    placeholder="Select a Prio" />
                </div>
                <div>
                    <div>State</div>
                    <select>
                        <option value="state1">To Do</option>
                        <option value="state2">In Progress</option>
                        <option value="state3">Awaiting Feedback</option>
                    </select>
                </div>
            </div>
            <div>
                <div>Assignees</div>
                <input type="text">
            </div>

                <p-button type="submit" [disabled]="isLoading">Save task</p-button>
                <p-button type="button" severity="secondary" [disabled]="isLoading" (click)="resetEdit()">Cancel</p-button>
            </div>
        </form>
    </p-sidebar>
    

<!-- columns -->

<!-- Tasks -->
<!-- 
<div *ngIf="!edit" style="padding: 32px 0px; display: flex; flex-direction: column; width: 200px">
    <h2>Add a new task</h2>
    <form (ngSubmit)="addNewTask()">
    <label for="taskTitle">Enter new task:</label>
    <input type="text" id="taskTitle" [(ngModel)]="taskTitle" name="taskTitle" [disabled]="isLoading"/>
    <textarea id="taskDescription" [(ngModel)]="taskDescription" name="taskDescription" [disabled]="isLoading"></textarea>
    <button type="submit" [disabled]="isLoading">Add new task</button>
    </form>
</div>-->


